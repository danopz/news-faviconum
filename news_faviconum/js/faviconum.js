'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}let Icon=function(){function a(b,c){_classCallCheck(this,a),this.options=c,this.canvas=b.createElement('canvas'),this.canvas.width=c.size,this.canvas.height=c.size,this.context=this.canvas.getContext('2d')}return _createClass(a,[{key:'render',value:function render(a){let b=this.options.size,c=b/2,d=this.options.padding,e=b-d;this.context.clearRect(0,0,b,b),this.context.fillStyle=this.options.background,this.context.beginPath(),this.context.arc(c,c,b/1.6,0,2*Math.PI),this.context.fill(),this.context.closePath(),this.context.strokeStyle=this.options.strokeColor,this.context.lineWidth=4,this.context.fillStyle=this.options.color;let f=parseInt(a/100);a%=100;let g=parseInt(a/10),h=a%10;return this.drawText(h,b*this.options.fontModifierBottom,'end','alphabetic',e,e),this.drawText(g,b*this.options.fontModifierBottom,'start','alphabetic',d,e),this.drawText(f,b*this.options.fontModifierTop,'center','hanging',c,d),{favicon:this.canvas.toDataURL('image/png'),type:'image/png'}}},{key:'drawText',value:function drawText(a,b,c,d,e,f){this.context.font='bold '+b+'px Arial',this.context.textAlign=c,this.context.textBaseline=d,this.context.strokeText(a,e,f),this.context.fillText(a,e,f)}}]),a}(),App=function(){function a(b,c){_classCallCheck(this,a),this.origFavicon=c.getAttribute('href'),this.origType=c.getAttribute('type'),this.title=b,this.favicon=c}return _createClass(a,[{key:'update',value:function update(a){let b=this.title.text.match(/\((\d+)\)/),c=this.origFavicon,d=this.origType;if(b){let e=b.pop(),f=a.render(e);c=f.favicon,d=f.type}this.favicon.setAttribute('href',c),this.favicon.setAttribute('type',d)}}]),a}(),Options=function a(b){_classCallCheck(this,a),this.strokeColor='rgba(0,0,0,0.6)',this.fontModifierTop=1.7*(1/3),this.fontModifierBottom=2.1*(1/3),this.size=64,this.padding=this.size/16,this.color='#fff',this.background='#000',b.hasOwnProperty('Theming')&&(this.background=b.Theming.color,b.Theming.inverted&&(this.color='#000',this.strokeColor='rgba(255,255,255,0.6)'))};(function(a,b){a.addEventListener('DOMContentLoaded',function(){let c=new Options(b),d=new Icon(a,c),e=a.querySelector('title'),f=new App(e,a.querySelector('head > link[rel="icon"]')),g=new MutationObserver(function(){f.update(d)});g.observe(e,{childList:!0})})})(document,OCA);
